<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CurseStudio Chat</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #1e1e2f;
  color: #fff;
  margin: 0;
  padding: 0;
}
#loginScreen, #chatScreen {display: none;}
#loginScreen {display:flex; height:100vh; justify-content:center; align-items:center; flex-direction:column;}
#chatScreen {display:flex; flex-direction:column; height:100vh;}
input, button {padding:8px; margin:5px; border-radius:5px; border:none;}
#messages {flex:1; overflow-y:auto; padding:10px; background:#2c2c3f;}
.message {margin:5px 0; padding:5px 10px; border-radius:5px; background:#3a3a50;}
.announcement {background:#ff4c4c;}
#inputContainer {display:flex;}
#inputContainer input {flex:1;}
</style>
</head>
<body>

<div id="loginScreen">
  <h1>CurseStudio Chat</h1>
  <input type="text" id="nickname" placeholder="Nickinizi girin">
  <button id="enterChat">Giriş Yap</button>
</div>

<div id="chatScreen">
  <div id="messages"></div>
  <div id="inputContainer">
    <input type="text" id="msgInput" placeholder="Mesaj yazın...">
    <button id="sendBtn">Gönder</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "FIREBASE_API_KEY",
  authDomain: "FIREBASE_PROJECT_ID.firebaseapp.com",
  databaseURL: "https://FIREBASE_PROJECT_ID-default-rtdb.firebaseio.com",
  projectId: "FIREBASE_PROJECT_ID",
  storageBucket: "FIREBASE_PROJECT_ID.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
let nickname = "";

const loginScreen = document.getElementById("loginScreen");
const chatScreen = document.getElementById("chatScreen");
const messagesEl = document.getElementById("messages");
const msgInput = document.getElementById("msgInput");
const sendBtn = document.getElementById("sendBtn");
const enterChat = document.getElementById("enterChat");
const nickInput = document.getElementById("nickname");

// Giriş yap
enterChat.onclick = () => {
  nickname = nickInput.value.trim() || "Anonim";
  loginScreen.style.display = "none";
  chatScreen.style.display = "flex";
  listenMessages();
};

// Mesaj gönder
sendBtn.onclick = sendMessage;
msgInput.addEventListener("keypress", e => {if(e.key==="Enter") sendMessage();});

function sendMessage(){
  const text = msgInput.value.trim();
  if(!text) return;
  db.ref("messages").push({nick:nickname, text, time:Date.now(), channel:"chat"});
  msgInput.value = "";
}

// Mesajları dinle
function listenMessages(){
  db.ref("messages").on("child_added", snap=>{
    const msg = snap.val();
    if(msg.channel==="chat" || msg.channel==="announcement"){
      const div = document.createElement("div");
      div.className = "message" + (msg.channel==="announcement"?" announcement":"");
      div.textContent = msg.channel==="announcement" ? msg.text : `${msg.nick}: ${msg.text}`;
      messagesEl.appendChild(div);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }
  });
}

// Duyuru ekleme (sadece server/admin kullanacak)
function addAnnouncement(text){
  db.ref("messages").push({nick:"CurseBot", text, time:Date.now(), channel:"announcement"});
}

// Local Storage reset kısa yolu
document.addEventListener("keydown", e=>{
  if(e.ctrlKey && e.shiftKey && e.key==="F9"){
    localStorage.clear();
    addAnnouncement("CurseBot: Chat Yönetici Tarafından Sıfırlandı");
    location.reload();
  }
});
</script>
</body>
</html>
