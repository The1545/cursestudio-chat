<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CurseStudio Chat</title>
<style>
body { font-family: Arial, sans-serif; margin:0; background:#1e1e2f; color:#fff; display:flex; flex-direction:column; height:100vh; }
header { background:#111; padding:1rem; text-align:center; font-size:1.5rem; font-weight:bold; }
#chat { flex:1; overflow-y:auto; padding:1rem; display:flex; flex-direction:column; gap:0.5rem; }
.message { padding:0.5rem 1rem; border-radius:8px; max-width:70%; word-wrap:break-word; }
.own { background:#4a90e2; align-self:flex-end; }
.other { background:#333; align-self:flex-start; }
.system { background:#ff5555; align-self:center; font-style:italic; }
#input-area { display:flex; padding:0.5rem; background:#111; }
#input-area input { flex:1; padding:0.5rem; border:none; border-radius:5px; margin-right:0.5rem; }
#input-area button { padding:0.5rem 1rem; border:none; border-radius:5px; background:#4a90e2; color:#fff; cursor:pointer; }
#nicknameModal { position:fixed; inset:0; background:rgba(0,0,0,0.9); display:flex; justify-content:center; align-items:center; flex-direction:column; color:#fff; }
#nicknameModal input { padding:0.5rem; border-radius:5px; border:none; margin-bottom:0.5rem; }
</style>
</head>
<body>

<header>CurseStudio Chat</header>

<div id="chat"></div>

<div id="input-area">
    <input type="text" id="message" placeholder="Mesaj yaz...">
    <button id="send">Gönder</button>
</div>

<div id="nicknameModal">
    <h2>Nick Belirle</h2>
    <input type="text" id="nicknameInput" placeholder="Nick">
    <button id="setNick">Başla</button>
</div>

<script>
// Kısa yol ve nick sistemi localStorage ile
let nickname = localStorage.getItem('nick') || ''
const chat = document.getElementById('chat')
const input = document.getElementById('message')
const sendBtn = document.getElementById('send')
const nicknameModal = document.getElementById('nicknameModal')
const nicknameInput = document.getElementById('nicknameInput')
const setNickBtn = document.getElementById('setNick')

// Eğer nick yoksa modal göster
if(!nickname){
    nicknameModal.style.display='flex'
} else {
    nicknameModal.style.display='none'
}

// Nick belirleme
setNickBtn.onclick = ()=>{
    if(nicknameInput.value.trim()){
        nickname = nicknameInput.value.trim()
        localStorage.setItem('nick', nickname)
        nicknameModal.style.display='none'
        loadMessages()
    }
}

// Mock backend: localStorage mesajlarıyla simüle ediyoruz
let messages = JSON.parse(localStorage.getItem('messages')||'[]')

// Mesaj gönder
sendBtn.onclick = sendMessage
input.addEventListener('keypress', e=>{ if(e.key==='Enter') sendMessage() })

function sendMessage(){
    const val = input.value.trim()
    if(!val) return
    messages.push({username:nickname, content:val, channel:'chat', timestamp:Date.now()})
    localStorage.setItem('messages', JSON.stringify(messages))
    input.value=''
    renderMessages()
}

// Mesajları göster
function renderMessages(){
    chat.innerHTML=''
    messages.forEach(msg=>{
        const div = document.createElement('div')
        div.textContent = `${msg.username}: ${msg.content}`
        div.className = msg.channel==='announcement' ? 'system' : (msg.username===nickname ? 'own':'other')
        chat.appendChild(div)
    })
    chat.scrollTop = chat.scrollHeight
}

// Admin reset: Ctrl+Shift+F9
document.addEventListener('keydown', e=>{
    if(e.ctrlKey && e.shiftKey && e.code==='F9'){
        messages=[]
        messages.push({username:'CurseBot', content:'Chat Yönetici Tarafından Sıfırlandı', channel:'announcement', timestamp:Date.now()})
        localStorage.setItem('messages', JSON.stringify(messages))
        renderMessages()
    }
})

// İlk yükleme
renderMessages()

// Simüle gerçek zamanlı: 1 saniyede bir güncelle
setInterval(()=>{
    messages = JSON.parse(localStorage.getItem('messages')||'[]')
    renderMessages()
},1000)
</script>

</body>
</html>
